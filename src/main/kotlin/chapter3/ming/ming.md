### 함수형 프로그래밍에서 재귀는 어떤 의미인가?
명령형 프로그램에 반복문이 있듯이 함수형에는 재귀가 있다. 함수형에서는 어떻게(how) 값을 계산할지 선언하는 대신 무엇(what)을 선언할지 고민해야 한다.(선언형 프로그래밍) 재귀 함수를 설계하기 위해서는 다음 조건을 만족해야 한다.
1. 종료 조건 정의
2. 함수 입력을 분할하여 어떤 부분에서 재귀를 호출할지 결정
3. 함수의 입력값이 종료조건으로 수렴하도록 재귀 호출의 입력값을 결정
   일반 재귀 함수는 느리고 스택 오버플로우가 발생할 수 있어 메모이제이션이나 꼬리 재귀로 최적화한다.

### 메모이제이션(memoization)은 무엇인가
메모이제이션은 반복된 연산 수행시 이전에 계산한 값을 캐싱하여 중복된 연산을 제거하는 방법이다. 예를 들어 피보나치 수열을 계산하는 재귀함수를 메모이제션을 활용하여 최적화하면 다음과 같다. 중간에 캐싱할 값을 파라미터로 전달하여 중복된 값을 메모리에 올리지 않도록 최적화할 수 있다.
```kotlin
// 기본 재귀 함수
fun fibo(n: Int) = when (n) {
	0 -> 0
	1 -> 1
	else fibo(n-1) + fibo(n-2)
}


// 메모이제이션
fun fiboFP(n: Int) = fiboFP(n, 0, 1)

tailrec fun fiboFP(n: Int, first: Int, second: Int) = when(n) {
	0 -> first
	1 -> second
	else -> fiboFP(n-1, second, first + second)
}
```

### 꼬리 재귀는 무엇인가?
어떤 함수가 직간접적으로 자기 자신을 호출하면서도 그 호출이 마지막인 연산을 꼬리 재귀라고 한다. 마지막 호출이 재귀 함수여야 하는데 그 이유는 컴파일러가 스택 프레임을 재사용할 수 있게 되기 때문이다. 재귀가 꼬리 호출인 경우, 재귀의 마지막 결과가 재귀 호출 전체의 결과와 일치하므로 컴파일러는 새로운 스택 프레임을 생성해서 재귀를 호출하지 않고 현재 스택 프레임에서 함수의 시작 지점으로 점프하여 재귀 호출을 할 수 있다.
```kotlin
// 기본 재귀 함수
fun reverse(str: String): String = when {
	str.isEmpty() => ""
	else => reverse(str.tail()) + str.head()
}

// 꼬리 재귀 함수
tailrec fun reverseTail(str: String, acc: String = ""): String = when {
	str.isEmpty() => acc
	else => {
	  val head = str.head()
	  return reverseTail(str.tail(), acc + head)
	}
}
```
- 누산값(acc)의 타입은 반환 타입과 같다.
- 종료 조건의 반환값은 반환값이거나 누산값을 포함한 연산 결과이다.
- 중간 결과값(예제에서 acc에 대입하는 값)을 만드는 순서는 보통 누산값 + 새로운값이다.(함수에 따라 아닐 수 있음)

##### 스택 프레임은 무엇인가?
함수 호출시 생성되는 데이터 구조로 실행에 필요한 정보를 담고 있다. 함수가 호출될때마다 스택 프레임에 쌓이며 반환되면 제거된다. 일반적으로 다음과 같은 요소로 구성된다.
- 리턴 주소 - 함수가 종료된 후, 호출된 위치로 돌아가기 위한 주소
- 인자 - 호출된 함수에 전달되는 인자
- 지역 변수 - 함수 내에 선언된 변수들
- 저장된 프레임 포인터 - 이전 스택 프레임을 가리키는 포인터로 함수 호출이 완료되면 이전 스택 프레임으로 돌아갈 수 있다.

##### 스택 프레임을 재사용한다?
일반 재귀의 경우 각 호출마다 스택 프레임이 쌓이게 된다.
1. reverse("abc")를 호출한다. -> 스택 프레임에 쌓임
2. reverse("abc")는 reverse("ab")를 호출하고 대기한다. -> 스택 프레임에 쌓임. 지역 변수가 있기 때문에 재사용 어려움
3. reverse("ab")는 reverse("a")를 호출하고 대기한다. -> 스택 프레임에 쌓임
4. reverse("a")는 reverse("")를 호출하고 대기한다. -> 스택 프레임에 쌓임
5. reverse("")는 ""를 반환한다. -> 스택 프레임에서 제거
6. .... reverse("abc")는 "cba"를 반환한다 -> 스택 프레임에서 제거

꼬리 재귀의 경우 재귀 호출이 함수의 마지막 작업이므로 현재 스택 프레임을 재사용할 수 있다.
1. reverseTail("abc")를 호출한다. -> 스택 프레임에 쌓임
2. reverseTail("abc")은 reverseTail("ab", "c")를 호출한다 -> 컴파일러가 현재 스택 프레임 재사용
3. reverseTail("ab", "c")은 reverseTail("a", "cb")를 호출한다 -> 컴파일러가 현재 스택 프레임 재사용
4. reverseTail("a", "cb")은 reverseTail("", "cba")를 호출한다 -> 컴파일러가 현재 스택 프레임 재사용
4. reverseTail("", "cba")은 cba를 반환한다. 
